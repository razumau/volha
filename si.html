<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Кубок княгини Ольги</title>
    <link rel="stylesheet" href="./css/bootstrap.min.css">
    <link rel="stylesheet" href="./css/main.css">
    <link rel="stylesheet" href="http://brick.a.ssl.fastly.net/PT+Sans:400,700,400i">
    <link rel="stylesheet" href="http://brick.a.ssl.fastly.net/Alegreya+Sans:400,700,400i">
    <script type="text/javascript">

          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-43833229-2']);
          _gaq.push(['_trackPageview']);

          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();

    </script>
</head>
<body>
<div class="container-fluid">
    <div class="row">
        <div class="col-md-8 col-md-offset-3 title">
            кубок княгини Ольги</div>
    </div>
    <div class="row">
        <ul class="col-md-2 col-md-offset-3 nav nav-pills nav-stacked">
            <li>
                <a href="./index.html">расписание</a>
            <li>
                <a href="./map.html">карта</a>
            <li>
                <a href="./chgk.html" data-no-instant>результаты <span class='caps'>чгк</span></a>
            <li class='active'>
                <a href="./si.html" data-no-instant>результаты <span class='caps'>си</span></a>
            <li>
                <a href="./eq.html">результаты <span class='caps'>эк</span></a>
            <li>    
                <a href="./regulations.html">регламент</a>
            <li>
                <a href="./editors.html">редакторы</a>
            <li>   
                <a href="./hotels.html" data-no-instant>гостиницы</a>
            <li>
                <a href="./list.html" data-no-instant>команды</a>
        </ul>
        <div class="col-md-6 main">
            <!--table class='table teams' id='mainTable'>
                <tr>
                    <th>#</th>
                    <th>команда</th>
                    <th>сумма</th>
                    <th>за&nbsp;<span class='figure'>50</span></th>
                    <th>за&nbsp;<span class='figure'>40</span></th>
                </tr>
            </table-->
            <table class="table teams" id="mainTable" style="visibility: visible;">
                <tbody><tr>
                    <th>#</th>
                    <th>команда</th>
                    <th>сумма</th>
                    <th>за&nbsp;<span class="figure">50</span></th>
                    <th>за&nbsp;<span class="figure">40</span></th>
                </tr>
            <tr><td class="figure">1</td><td>Негодный буцентавр</td><td class="figure">1080</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">2</td><td>МИД-2</td><td class="figure">880</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">3</td><td>Дикие бозоны Хиггса</td><td class="figure">850</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">4</td><td>Тапир на весь мир</td><td class="figure">840</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">5</td><td>InterzaNOza</td><td class="figure">830</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">6</td><td>Всё дело в перце</td><td class="figure">800</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">7</td><td>Механический балет</td><td class="figure">780</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">8</td><td>X-Com</td><td class="figure">750</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">9</td><td>Страпелька </td><td class="figure">730</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">10</td><td>Шулер </td><td class="figure">720</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">11</td><td>Дельтаплан</td><td class="figure">700</td><td class="figure">4</td><td class="figure"></td></tr><tr><td class="figure">12</td><td>Middle</td><td class="figure">700</td><td class="figure">3</td><td class="figure"></td></tr><tr><td class="figure">13</td><td>Одушевлённые аэросани</td><td class="figure">680</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">14</td><td>Церебрум</td><td class="figure">670</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">15</td><td>Гремлины</td><td class="figure">660</td><td class="figure">4</td><td class="figure"></td></tr><tr><td class="figure">16</td><td>Эллада</td><td class="figure">660</td><td class="figure">3</td><td class="figure"></td></tr><tr><td class="figure">17</td><td>Весёлые однорукие гномы</td><td class="figure">640</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">18</td><td>Васход</td><td class="figure">620</td><td class="figure">4</td><td class="figure">7</td></tr><tr><td class="figure">19</td><td>Kéisécker</td><td class="figure">620</td><td class="figure">4</td><td class="figure">6</td></tr><tr><td class="figure">20</td><td>New-реанимация</td><td class="figure">620</td><td class="figure">4</td><td class="figure">4</td></tr><tr><td class="figure">21</td><td>Любовь Каксон</td><td class="figure">620</td><td class="figure">3</td><td class="figure"></td></tr><tr><td class="figure">22</td><td>Стая</td><td class="figure">580</td><td class="figure">3</td><td class="figure">4</td></tr><tr><td class="figure">23</td><td>Хронически разумные United</td><td class="figure">580</td><td class="figure">3</td><td class="figure">3</td></tr><tr><td class="figure">24</td><td>Смешная</td><td class="figure">530</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">25</td><td>Руна</td><td class="figure">510</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">26</td><td>Яровит</td><td class="figure">490</td><td class="figure">2</td><td class="figure">5</td></tr><tr><td class="figure">27</td><td>Кот да Винчи</td><td class="figure">490</td><td class="figure">2</td><td class="figure">4</td></tr><tr><td class="figure">28</td><td>Нео</td><td class="figure">490</td><td class="figure">0</td><td class="figure"></td></tr><tr><td class="figure">29</td><td>Штандарт</td><td class="figure">480</td><td class="figure">2</td><td class="figure">4</td></tr><tr><td class="figure">30</td><td>Ultima Ratio</td><td class="figure">480</td><td class="figure">2</td><td class="figure">3</td></tr><tr><td class="figure">31</td><td>Пошатучие шебуршунчики</td><td class="figure">460</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">32</td><td>Summa Technologiae</td><td class="figure">430</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">33</td><td>Невкусный тюлень</td><td class="figure">410</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">34</td><td>VIP</td><td class="figure">390</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">35</td><td>Так говорил Жора Шустрый</td><td class="figure">380</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">36</td><td>Ход конём</td><td class="figure">360</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">37</td><td>Нелюди в белом</td><td class="figure">330</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">38</td><td>Мы</td><td class="figure">320</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">39</td><td>Имитируем сарказм</td><td class="figure">310</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">40</td><td>Дятлы</td><td class="figure">290</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">41</td><td>Ять </td><td class="figure">280</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">42</td><td>Этанол эталона</td><td class="figure">250</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">43</td><td>Горячие головы</td><td class="figure">230</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">44</td><td>Альтаир</td><td class="figure">220</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">45</td><td>Пчёлы Севера</td><td class="figure">200</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">46</td><td>Доведённые до сарказма</td><td class="figure">200</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">47</td><td>ХЗИВ</td><td class="figure">190</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">48</td><td>Дядька Petrick</td><td class="figure">180</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">49</td><td>Пиромане</td><td class="figure">170</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">50</td><td>Ace on the river</td><td class="figure">160</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">51</td><td>Вкусно и хорошо </td><td class="figure">160</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">52</td><td>Варка Экскалибура</td><td class="figure">110</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">53</td><td>Енотики-7</td><td class="figure">100</td><td class="figure"></td><td class="figure"></td></tr><tr><td class="figure">54</td><td>Любовь</td><td class="figure">90</td><td class="figure"></td><td class="figure"></td></tr></tbody></table>
            
    </div> 
</div>
</div>      
<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
<script src='./js/tabletop.js'></script>
<script src='./js/spin.min.js'></script>
<script src="./js/instantclick.js" data-no-instant></script>
<script data-no-instant>InstantClick.init();</script>
<script type="text/javascript">

    //var spinner = new Spinner().spin();
    //$('#mainTable').append(spinner.el);

    //window.onload =  function() { init() };


    var public_spreadsheet_url = 'https://docs.google.com/spreadsheet/pub?hl=en_US&hl=en_US&key=1fKt2k8ffYXlK0T5S6Ne2EDmdV2gE15TKF7D--j5xKI4&output=html';

    function init() {

        Tabletop.init( { key: public_spreadsheet_url,
                         callback: createTable,
                         simpleSheet: true } )
    }

    function addToTable (table, v, number) {

        table.push('<tr><td class="figure">');
        table.push((number).toString());
        table.push('</td><td>');
        table.push(v['команда']);
        table.push('</td><td class="figure">');
        table.push(v['сумма']);
        table.push('</td><td class="figure">');
        table.push(v['пятьдесят']);
        table.push('</td><td class="figure">');
        table.push(v['сорок']);
        table.push('</td>');
        table.push('</tr>');
    }

    function createTable (data, tabletop) {
        var mainTable = [], 
            mainCount = 1;
            
        data.sort(function (a, b) {
           var result = b['сумма'] - a['сумма'];
           if (result === 0) {
               result = b['пятьдесят'] - a['пятьдесят'];
           }
           if (result === 0) {
                result = b['сорок'] - a['сорок'];
           }
            return result;
        });

        data.forEach (function (v, index){                
            addToTable(mainTable, v, mainCount++);
        });
        
        $('table').css("visibility", "visible");
        $('#mainTable').append(mainTable.join(''));
        spinner.stop();
    }

</script>
</body>
</html>
